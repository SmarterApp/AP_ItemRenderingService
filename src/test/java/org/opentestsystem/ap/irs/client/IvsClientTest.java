package org.opentestsystem.ap.irs.client;

import org.junit.Before;
import org.junit.Test;
import org.opentestsystem.ap.irs.config.IvsServiceProperties;

import java.util.Arrays;
import java.util.List;

import static org.assertj.core.api.Assertions.assertThat;

public class IvsClientTest {

    private final List<String> itemIds = Arrays.asList("100001", "200002");

    private final String bankKey = "187";

    private IvsServiceProperties props;

    @Before
    public void setup() {
        this.props = new IvsServiceProperties();
        props.setExternalHost("http://localhost:8200");
    }

    @Test
    public void testGenerateRenderUrl() {
        final IvsClient client = new IvsClient(props);
        final String url = client.getRenderUrl(bankKey, bankKey, itemIds);
        assertThat(url).isEqualTo("http://localhost:8200/items?ids=187-100001,187-200002&loadFrom=/home/tomcat7/content/187");
    }

    @Test
    public void testGenerateIdString() {
        final IvsClient client = new IvsClient(props);
        final String idString = client.generateIdString(bankKey, itemIds);
        assertThat(idString).isEqualTo("187-100001,187-200002");
    }
}
